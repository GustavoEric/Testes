' Gambas class file

'copie e cole este código na seção de variáveis 
Private SComm As SerialPort 
Const None As Integer = 0
Private Rx As String 

Public Sub Form_Open()

End

Public Sub btnConectar_Click()

  'configura a porta de conexão e sua velocidade
SComm = New SerialPort As "SComm"
SComm.PortName = "/dev/ttyUSB0"
SComm.Speed = 9600
SComm.Parity = 0
SComm.DataBits = "8"
SComm.StopBits = "1"
SComm.FlowControl = 0
SComm.Open()

'liga o Timer
tmConexao.Enabled = True

End

Public Sub tmConexao_Timer()

'chama a funcao de leitura da porta serial
SComm_Read

End

Public Sub SComm_Read()
Read #SComm, Rx, Lof(SComm)
If CStr(Rx) <> "" Then
lblResultado.Text = CStr(Rx)
LCD.text = CStr(rx)
Endif
End